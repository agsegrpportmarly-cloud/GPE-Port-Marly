<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Espace adhérents – Port‑Marly</title>

  <!-- Même feuille de style que les autres pages (chemin relatif car on est dans /adherents/) -->
  <link rel="stylesheet" href="../Style.css">
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">

  <!-- Mini styles locaux non intrusifs -->
  <style>
    .dashboard { max-width: 1200px; margin: 0 auto; padding: 0 24px 48px; }
    .tiles { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 24px; }
    .tile { display: block; text-decoration: none; }
    .actions { display: flex; gap: 12px; align-items: center; justify-content: flex-end; margin: -20px 0 24px; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <!-- HEADER strictement identique (markup) à vos autres pages -->
  <header class="hero">
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <nav>
      <a href="/Index.html">Accueil</a>
      <a href="/Activites.html">Activités</a>
      <a class="active" href="/adherents/">Espace adhérents</a>
      <a href="/Pre-inscriptions.html">Pré-inscriptions</a>
    </nav>
  </header>

  <main class="dashboard" role="main">
    <div class="actions">
      <button id="loginBtn" class="btn">Se connecter</button>
      <button id="logoutBtn" class="btn hidden">Se déconnecter</button>
    </div>

    <!-- Tuiles simplifiées : pas de "Dossiers" ni doublons -->
    <section class="tiles" aria-label="Navigation espace adhérents">
      <a class="tile" href="#claire-2pm">
        <h3>Clairière 2PM</h3>
        <p>Créer / modifier un dossier d’adhésion.</p>
      </a>

      <a class="tile" href="#meute-8pm">
        <h3>Meute 8ème Port‑Marly</h3>
        <p>Créer / modifier un dossier d’adhésion.</p>
      </a>

      <a class="tile" href="#chefs">
        <h3>Chefs &amp; Responsables</h3>
        <p>Formulaire et documents pour les chefs.</p>
      </a>
    </section>
  </main>

  <script>
    // Placeholders simples pour afficher/masquer les boutons (remplacer par votre auth)
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    let isAuthenticated = false;
    function render(){
      loginBtn.classList.toggle('hidden', isAuthenticated);
      logoutBtn.classList.toggle('hidden', !isAuthenticated);
    }
    render();
    loginBtn.addEventListener('click', ()=>{ isAuthenticated = true; render(); });
    logoutBtn.addEventListener('click', ()=>{ isAuthenticated = false; render(); });
  </script>
</body>
</html>

  <script>
    // ---------- CONFIG AUTH0 (tes valeurs) ----------
    const AUTH0_DOMAIN   = "dev-zl3rulx7tauw5f4h.us.auth0.com";
    const AUTH0_CLIENTID = "etdVdsWZQSoyQtrNdUKDRxytmXM4cZFL";
    // ------------------------------------------------

    let auth0Client;
    const $ = (s, r=document) => r.querySelector(s);
    const show = (el) => el.classList.remove('hide');
    const hide = (el) => el.classList.add('hide');

    async function initAuth0() {
      auth0Client = await auth0.createAuth0Client({
        domain: AUTH0_DOMAIN,
        clientId: AUTH0_CLIENTID,
        authorizationParams: {
          redirect_uri: window.location.origin + "/adherents/",
        },
        cacheLocation: "localstorage",
        useRefreshTokens: true
      });

      // Callback Auth0 (retour redirection)
      const q = window.location.search;
      if (q.includes("code=") && q.includes("state=")) {
        await auth0Client.handleRedirectCallback();
        window.history.replaceState({}, document.title, window.location.pathname);
      }

      bindUI();
      await render();
    }

    function bindUI() {
      $("#btn-login")?.addEventListener("click", () => auth0Client.loginWithRedirect());
      $("#btn-logout")?.addEventListener("click", () =>
        auth0Client.logout({ logoutParams: { returnTo: window.location.origin + "/adherents/" } })
      );
    }

async function render() {
  const isAuth = await auth0Client.isAuthenticated();

  if (!isAuth) {
    show($("#guest"));
    show($("#btn-login"));
    hide($("#btn-logout"));
    hide($("#app"));
    return;
  }

  const user = await auth0Client.getUser();
  $("#welcome").textContent = `Bienvenue, ${user?.name || user?.email || "utilisateur"} !`;
  hide($("#guest"));
  hide($("#btn-login"));
  show($("#btn-logout"));
  show($("#app"));
}

    window.addEventListener("DOMContentLoaded", initAuth0);
  </script>