<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Espace adhérents – Port-Marly</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="stylesheet" href="../Style.css">
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">

  <!-- Auth0 SPA SDK (front) -->
  <script defer src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"></script>
  <!-- Logique d’auth/affichage -->
  <script defer src="./auth.js"></script>

  <style>
    .container{max-width:1100px;margin:0 auto;padding:24px}
    .btn{padding:.6rem 1rem;border:1px solid #ccc;border-radius:.6rem;background:#043956;cursor:pointer;color:#fff}
    .btn.primary{border-color:#005c84;background:#005c84}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:2rem}
    .card{border:1px solid #e5e7eb;border-radius:16px;padding:18px;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .muted{color:#6b7280}
    .hide{display:none}
    nav a{margin-right:1rem}
    /* Le header doit être positionné pour accueillir le bouton absolu */
.hero { position: relative; }

/* Container du bouton en haut-droite */
.auth-float {
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 50;
}

/* Style du bouton – look discret sur image */
.pill {
  display: inline-block;
  padding: .45rem .9rem;
  border-radius: 999px;
  font-weight: 600;
  text-decoration: none;
  border: 1px solid rgba(255,255,255,.6);
  background: rgba(0,0,0,.35);
  color: #fff;
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 10px rgba(0,0,0,.25);
}
.pill:hover { background: rgba(0,0,0,.5); }

/* Variante quand on est connecté (optionnel) */
.pill.logout {
  border-color: #005c84;
  background: #005c84;
}
.pill.logout:hover { filter: brightness(1.05); }

  </style>
</head>
<body>
  <header class="hero">
    <!-- Bouton flottant en haut à droite -->
<div class="auth-float">
  <a href="#" id="auth-cta" class="pill">Se connecter</a>
</div>
    <br><br><br><br><br><br><br>
<nav class="topnav">
  <div class="left">
    <a href="/Index.html">Accueil</a>
    <a href="/Activites.html">Nos unités</a>
    <a href="/adherents/">Espace adhérents</a>
    <a href="/preinscriptions.html">Pré-Inscriptions</a>
  </div>

  <div class="right">
    <a href="#" id="link-login"  class="button">Se connecter</a>
    <a href="#" id="link-logout" class="button secondary hide">Se déconnecter</a>
  </div>
</nav>

  </header>

  <main class="container">
    <!-- Boutons pilotés par auth.js -->


    <!-- Visiteur non connecté -->
    <section id="guest">
      <p class="muted"><b>Section réservée aux adhérents.</b> Merci de vous connecter.</p>
    </section>

    <!-- Connecté sans rôle -->
    <section id="no-role" class="hide">
      <p class="muted">Vous êtes connecté mais vous n’avez pas encore d’accès.</p>
      <button id="btn-request-access" class="btn">Demander l’accès</button>
    </section>

    <!-- Connecté (avec rendu selon rôles) -->
    <section id="app" class="hide">
      <p class="muted" id="welcome"></p>

      <!-- Fieldset 1 : Administratif — visible UNIQUEMENT si l’utilisateur a ≥1 rôle -->
      <fieldset id="fs-general" class="hide">
        <legend>Administratif</legend>
        <div class="grid">
          <a class="card" href="https://inscriptions-district-sgl.web.app/formulaire-inscription.html?type=jeune" target="_blank">
            <img src="../images/folder.png" alt="inscription" style="width:100%;border-radius:8px">
            <h3>Dossier d'inscription</h3>
          </a>
          <a class="card" href="/adherents/chefs.html">
            <img src="../images/camp.png" alt="camp" style="width:100%;border-radius:8px">
            <h3>Dossier d'inscriptions Camps</h3>
          </a>
          <a class="card" href="/adherents/dossiers.html">
            <img src="../images/calendar.png" alt="agenda" style="width:100%;border-radius:8px">
            <h3>Agenda</h3>
          </a>
        </div>
      </fieldset>

      <br>

      <!-- Fieldset 2 : Les unités — visible si ≥1 rôle, filtrage possible via data-roles -->
      <fieldset id="fs-roles" class="hide">
        <legend>Les unités</legend>
        <div class="grid" id="role-cards">
          <!-- Par défaut : rôles “chef,admin”. Adapte selon ton mapping réel -->
          <a class="card" href="/PM/adherents/meute 1PM/index.html" data-roles="M1PM,admin">
            <h3>Meute 1ère <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/meute 3PM/index.html" data-roles="M3PM,admin">
            <h3>Meute 3ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/clairiere 2PM/index.html" data-roles="C2PM,admin">
            <h3>Clairière 2ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/clairiere 4PM/index.html" data-roles="C4PM,admin">
            <h3>Clairière 4ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/troupe 1 PM/index.html" data-roles="T1PM,admin">
            <h3>Troupe 1ère <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/troupe 3 PM/index.html" data-roles="T3PM,admin">
            <h3>Troupe 3ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/compagnie 2PM/index.html" data-roles="CI2PM,admin">
            <h3>Compagnie 2ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/compagnie 4PM/index.html" data-roles="CI4PM,admin">
            <h3>Compagnie 4ème <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/Feu/index.html" data-roles="FNDJ,admin">
            <h3>Feu<br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
          <a class="card" href="/PM/adherents/clan/index.html" data-roles="CSG,admin">
            <h3>Clan <br>Port Marly</h3>
            <p>Accéder à la page de l'unité.</p>
          </a>
        </div>
      </fieldset>
    </section>
  </main>

  <footer>
    © AGSE – Groupes de Port-Marly <img src="../images/Logo_GS.png" alt="Logo AGSE" width="120" height="auto">
  </footer>
</body>
</html>
